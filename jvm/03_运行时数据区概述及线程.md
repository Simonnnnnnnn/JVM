# 运行时数据区概述及线程

---

## 1.概述

![](/images/26.png)

![](/images/27.png)

![](/images/28.png)

![](/images/29.png)

- 内存是非常重要的系统资源，是硬盘和CPU的中间仓库及桥梁，承载着操作系统和应用程序的实时运行。JVM内存布局规定了Java在运行过程中内存申请、分配、管理的策略，保证了JVM的高效稳定运行。**不同的JVM对与内存的划分方式和管理机制存在着部分差异**（注意：三大虚拟机中只有HotSpot是有方法区的）

![](/images/30.png)

- Java虚拟机定义了若干种程序运行期间会使用到的运行时数据区，其中有一些会随着虚拟机启动而创建，随着虚拟机退出而销毁。另外一些则是与线程一一对应的，这些与线程对应的数据区域会随着线程开始和结束而创建和销毁
- 灰色的为单独线程私有的，红色的为多个线程共享的。即
  - 每个线程：独立包括程序计数器、栈、本地栈
  - 线程间共享：堆、堆外内存（永久代或元空间、代码缓存）
  - PC：程序计数器
  - VMS：虚拟机方法栈
  - NMS：本地方法栈

- 关于线程间共享的说明

  ![](/images/31.png)

## 2.线程

- 线程是一个程序里的运行单元。JVM允许一个应用有多个线程并行的执行
- 在HotSpot JVM里，每个线程都与操作系统的本地线程直接映射
  - 当一个Java线程准备好执行以后，此时一个操作系统的本地线程也同时创建。Java线程执行终止后，本地线程也会回收
- 操作系统负责所有线程的安排调度到任何一个可用的CPU上。一旦本地线程初始化成功，它就会调用Java线程中的run()方法

### 2.1 JVM系统线程

![](/images/32.png)

